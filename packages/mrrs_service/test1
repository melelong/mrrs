
# # 打包阶段
# FROM node:20.10.0-alpine3.19 as build-stage
# # 进入打包阶段镜像里的/app_build目录
# WORKDIR /app_build

# # 复制docker build命令中整个工作区的配置文件到app_build目录下
# COPY pnpm-workspace.yaml pnpm-lock.yaml ./

# # 复制 utils 和 mrrs_service 文件夹
# COPY utils ./utils
# COPY packages/mrrs_service ./packages/mrrs_service

# # 安装pnpm
# RUN npm install -g pnpm 
# # 使用 pnpm 安装 mrrs_service 和它的依赖
# RUN pnpm install --filter mrrs_service...

# # 进入打包阶段镜像里的mrrs_service子项目打包
# WORKDIR /app_build/packages/mrrs_service
# RUN pnpm run build

# # 生产阶段
# FROM node:20.10.0-alpine3.19 as production-stage
# # 进入生产阶段镜像里的/app_pro目录
# WORKDIR /app_pro
# #从打包阶段镜像中复制打包后的产物
# COPY --from=build-stage /app_build/packages/mrrs_service/dist /app_pro
# COPY --from=build-stage /app_build/packages/mrrs_service/package.json /app_pro/package.json

# # 为生产环境安装依赖
# RUN npm install -g pnpm
# RUN pnpm install --prod

# # 暴露端口
# EXPOSE 3000
# # 启动服务
# CMD ["node", "app_pro/dist/main.js"]